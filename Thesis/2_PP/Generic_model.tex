%\addbibresource{../../Bibliography/bib_zotero20171106}

%\chapter{Mechanistic model for plant community dynamics centred around carbon allocation}
%Paper 1:
%\section{Introduction}

\begin{fullwidth}
The objective of this chapter is to develop the core concepts of the model, introduced in the previous chapter, and to explain the structure and design choices made during the model development. The first part focuses on the general context of alpine grasslands and some coexistence mechanisms at stake. The following part details the definition of the strategy space and the modelling of phenotypic plasticity while introducing the key concepts of species memory and individual experience. Finally, the last part is a detailed description of the model following \parencite{grimm_standard_2006} recommendations.
\end{fullwidth}

\chapter{Alpine environment: conditions, resources, and perturbations}
\section{The scales of alpine grasslands}

\paragraph{The scale}
The \textemph{scale} is a determinant variable in the quantification of mechanisms that structure ecological communities \parencite{bello_hierarchical_2013}, and therefore in modelling approaches. It is chosen based on structures that the modeller intends to explore and determine the upper limit of mechanisms the model can reproduce. Large scales will favour geo-climatic and dispersal effects \parencite{kleidon_global_2000} while small scales will focus on direct plant interactions processes or resource heterogeneity \parencite{ soussana_gemini:_2012, maire_plasticity_2013, taubert_modelling_2014}. This is true for spatial scale, but also temporal scales. Because mechanisms studies at large scales like dispersion, invasion, speciation occur over long time scales whereas mechanisms occurring at smaller spatial scale, like competition, facilitation, disturbances play a role on shorter time scales, spatial and temporal scales are often correlated. The scales are also dependent on the studied environment. There is a high contrast between highly productive environments like tropical forests and unproductive environments like mountain grasslands. The dimensions of individuals themselves are a constraint on the scales: while tropical trees grow few tens of meter high and above one meter diameter, alpine grasses do not exceed half a meter \parencite{korner_alpine_2003}. Similar differences in the order of magnitude can be observed for life cycles between long live tree and annuals or bi-annuals grasses. The focus of this work being on plant functioning and interaction mechanisms, the scale of the model will be around the meter, while the temporal scale will be in the order of the season.

\paragraph{The resolution} The same way the scales are constraint by the size or length of the individual, the \textemph{resolution} should be close to the size of the modelled entities. The resolution is also determined by the focus of the model: interactions between individuals must be distinct and not blended to hope see the emergence of spatial patterns. Cell size and time step length should be small enough to take into account heterogeneity that is an important driver of diversity. For these reasons, the spatial resolution is set up to the centimetre and the temporal resolution to the day (can be changed but processes might not scale well).

\paragraph{Complexity and performance}
Once the resolution is fixed there is always the temptation to increase the size, or scale, of the system. This should be avoided for two main reasons. (1) the increase of scale with relatively fine resolution lead to a high increase in computational power required for simulations that are already complex. (2) there is a high chance that the processes modelled at fine resolution lose their sense when scale increases. Indeed, as mentioned, the importance of processes at stake is often dependant on the scale the system is studied. The effect of higher scale processes is often taken into account in inputs or parameters. Calibration of these parameters against certain data is a way to better understand these processes \parencite{lagarrigues_approximate_2015}. 

\section{Resources: light and water}
As mentioned in the previous chapter, resource fluctuations, heterogeneity, and competition are important factors for coexistence. Unlike animals, plants mainly compete for the same resources: light, water and nutrients. Light is the source of energy that allows the transformation of inorganic carbon into organic matter through photosynthesis. Water has multiple functions in plants: transport, structural support, and oxygen supply for photosynthesis. Nutrients are used in the construction of cells and cell walls, and especially the production of proteins that act as cell machinery.

\section{Perturbations: frost, grazing, and mowing}
\paragraph{Climate}
The most notable specificity of mountain grasslands is the climate. While there is a wide range of mountain grasslands type, the focus of this document is in French Alps. The alpine climate in France is characterised by cold winter with snow precipitations and dry summer. The growing season is relatively short and spread between May and October in low altitude, and June and September in high altitude \parencite{korner_alpine_2003}. The particularity of this habitat is the presence of snow cover during winter that protects soil, rhizomes, and seeds from negative temperatures. Because of this, seasons are decomposed in the model based on the snow melt in spring/summer and the first snowfall in winter. While a rise in temperature is needed to allow snow to melt down, frost event can occur after the beginning of the season. Such events represent strong environmental filter for non-adaptive plants that do not invest in specific resistance mechanisms to favour early germination and growth. Therefore there is a strategic trade-off between germination date and early growth with frost resistance.

\paragraph{Management}
Another specificity of alpine grasslands is that they are subject to changing management practices. Mountain grazing by domestic cattle was fairly common in the Alps, but changes in agricultural practices and a decrease in productivity due to drought lead to less and less grazing or mowing for fodder in alpine grasslands. These two types of management have different impacts on the community. While mowing is non-specific and favours small plants, herbivory is known to be specific when the production is greater than the grazing pressure. Leaves with high nutrient content and low structural tissues content are generally favoured because of high input and high digestibility. The grazing pressure plays as equalizing mechanisms as it favours conservative species with lower competitive ability.

Other forms of herbivory can happen in grassland context, but the extent of the grazing by large herbivores reduce the relative importance of this effect and allows us to ignore this diversity of herbivory sources with complex dynamics.


\chapter{Multi-dimensional strategy space, carbon pools, and trade-offs} \label{chapter:strategy-space}
\section{Multi-dimensional strategy space and allocation pools}
%Leaf economic spectrum + Shipley + Poorter
%
%\subsection{Allocation or anatomy: a choice to make}
%what is SLA and SRL: cost of exchange area: tissue density, tissue thickness. Poorter 2009, grace2017, Katabuchi 2017, de la Riva 2016\\
%THere is not only coordination -> part of RSR is explained by SRL:SLA\parencite{freschet_explaining_2015}. Multiple sources of information (memory) that affects these traits: composite traits that affect multiple fitness dimension -> memory not only for the climate. -> but also coordination. A more tight trade-off for root with smaller changes in SRL and more changes in RMF, the opposite for SLA. Need for a model that allows such asymmetry. 
%\parencite{freschet_integrated_2015}
%\\
%within species LES %hu_novel_2015

\subsection{The strategy space in \model}

\paragraph{What is a strategy space}
In an ecological agent-based simulation model a species will be defined by its values for the species-specific parameters. They can be estimated from experimental data \parencite{taubert_modelling_2014, maire_traits_2009,lohier_explaining_2014} or be picked from a strategy axis \parencite{reineking_environmental_2006, kleidon_global_2000} composing a strategy space \parencite{westoby_leaf-height-seed_1998}. The diversity of the species pool will depend on the number of values for each of these specific parameters, or traits, and the number of these traits. Each trait increasing the dimension of the strategy space \parencite{laughlin_intrinsic_2014}. The ambition of this model is to simulated rich plant communities, the definition of these axes is crucial. Trade-offs between traits are excellent applicants for these specific parameters as they reduce the dimensionality of phenotypes to a small number of dimensions \parencite{wright_worldwide_2004, diaz_global_2016, reich_world-wide_2014} while keeping the information of traits needed to describe the plant functioning. Trade-offs emerge from ecological and physical or biological constraints, by considering these constraints Darwinian demons are avoided.\\

While considering too many axes does not improve community description, a certain number is needed to have strategic diversity \parencite{laughlin_intrinsic_2014}. This is intuitively explained by the fact that each trade-off is closely related to a particular aspect of fitness or mechanism for coexistence (\textit{e.g.} reproduction, competitive ability, resistance to resource shortage, predation, etc.). In this model, multiple aspects of plant life are represented: germination with the germination rate for storage effect \parencite{chesson_general_2000, adler_climate_2006}, dispersion with seed mass \parencite{westoby_leaf-height-seed_1998} or tissue construction cost \parencite{reich_leaf_1992, wright_worldwide_2004, reich_world-wide_2014}. Main components of plant growth and life history are covered by such trade-offs and driven by mechanisms shared by all vegetation systems. Because of that, the model has a great potential of genericity and diversity. It can be easily adapted to other plant communities with specific calibration, and extended to couples of biological process and differentiation axis (\textit{e.g.} root herbivory and associated resistance carbon pool). The the trade-offs used in the model are detailed in the model description below \sidenote{see section \ref{chapter:model-description}.}. These axes should, in such models, be independent, (\textit{i.e.} it is physically and biologically possible for a plant to take any position in the space drawn by two given axis) and result from physical or biological laws (ensuring that impossible strategies are indeed excluded from the model). First, it is a condition for parsimony of the model. The second and more interesting reason is that any trade-off emerging from the model should have an ecological interpretation \parencite{maire_disentangling_2013}. \\
 

One way of constraining plant strategies to certain axes is to consider allocation trade-offs \parencite{kleidon_global_2000, reineking_environmental_2006}. An allocation trade-off is the translation of the mass conservation rule that prevents the allocation of biomass to distinct carbon pools. If biological functions are related to organic matter pools (photosynthesis to leaves, water and nutrient uptake to roots), then the sum of biomass to invest in each carbon pool (therefore in each function) cannot exceed the total available biomass: leaving the plant with a choice on the balance between the different functions. Allocation trade-offs have the advantage to be easily implemented and be intuitive. By design, a partitioning factor value corresponds to a position on the related strategic axis. In \model, 5 main trade-offs are captured by allocation trade-off: (1) development vs reproduction: partitioning factor between reproduction and maintenance of vegetative tissues (when plant is mature), (2)  persistence vs dispersion: partitioning of reproduction biomass between persistence (storage) and production of new propagules (seed/clone production), (3) aboveground vs belowground competition: investment between shoot and root, \parencite{kleidon_global_2000, reineking_environmental_2006, taubert_modelling_2014}(4) slow vs fast: construction cost trade-offs between active and structural tissues in both shoot and root and (5) growth vs resistance: partitioning between stored biomass and frost resistance carbohydrates \parencite{cai_changes_2004}. This last trade-off can be extended to other carbon pools of specific resistances, for example to herbivory. Modification of these coefficients during life history is a way to introduce plasticity in the model. The rules driving such changes for some of this partitioning parameters are described in the following section.\\


One of these trade-offs, (4) slow vs fast, is key and related to the construction cost of organs (independently leaves and roots). Highlighted at the global scale and for leaves, the Leaf Economic Spectrum \parencite{wright_worldwide_2004} draws a strategic differentiation axis from conservative slow species and exploitive fast species. The construction cost has long been identified as a factor of strategic differentiation in plant communities\parencite{westoby_leaf-height-seed_1998}. This strategic axis, being related to many functional traits: SLA, LDMC, LNC, leaf longevity, Amass, etc.\parencite{wright_worldwide_2004} is of crucial importance. First, these traits are closely related to the characterisation of plant communities and the assessment of services \parencite{grime_benefits_1998}. Second strong links and correlations can be made between these soft traits physiological traits \parencite{craine_functional_2002, reich_variation_2003, wright_worldwide_2004}. Finally, a species resource use strategy is closely related to its responses and vulnerability to changing conditions \parencite{poorter_causes_2009, dwyer_specific_2014, deleglise_drought-induced_2015}. The traits related to this trade-off play a major role both in individual growth and physiology and in community services and response to a gradient. Therefore it is essential to the model. Analysing the underlying mechanisms for such strong trade-off is necessary to implement satisfying representation in the model.\\

%\textbf{Change this: maybe start with Shipley results, then composite stuff. Question: should it be here, or in the following part ?}

These trade-offs between highly productive tissues with low construction cost and short lifespan called exploitative, and more conservative strategy with longer lifespan but lower productivity are mainly observed thanks to soft traits such as SLA for LNC \parencite{wright_worldwide_2004}. Mechanistic models require traits related to physiology and organ performance \parencite{soussana_gemini:_2012, lohier_explaining_2014}, but a link can generally be done between these traits and soft traits. However, traits such as SRL or SLA are composite traits emerging from different organ properties \parencite{ryser_importance_1996,john_anatomical_2017}, where tissue density and organ thickness are the main determinants. "\textit{A necessary trade-off between allocation to structural tissues versus liquid phase processes}" has been identified by Shipley et al. \parencite{shipley_fundamental_2006} as one of the two main factors for the leaf economic spectrum to emerge. Such allocation trade-off can indeed explain differences in construction cost as the liquid phase corresponding to the "active" part of plant tissue, the cell content, have much lower dry volumetric mass than its "structural" counterpart, the cell-wall. Also, active tissues containing the protein machinery for photosynthesis and water absorption, a higher proportion of high protein concentration tissue would be correlated to higher nitrogen concentration in the organ on the "fast-slow" spectrum, along with a higher mass-based photosynthetic rate \parencite{reich_world-wide_2014}. On the other end, the structural tissues give the organ a higher lifespan \parencite{mediavilla_internal_2001, ryser_importance_1996} that compensate for lower productivity \parencite{westoby_time_2000}. Such trade-off can be apply to both shoot and roots \parencite{craine_functional_2002,  tjoelker_linking_2005, reich_world-wide_2014}. From that, the decomposition of organs between active and structural tissues constitutes a strong basis to model construction cost trade-offs as the main parts of the global strategy space.\\

A similar axis of differentiation has been demonstrated for roots \parencite{reich_world-wide_2014, tjoelker_linking_2005, picon-cochard_effect_2012}. The necessity for independent similar axis for leaves and root can be discussed with respect to coordination between shoot and root activities. Because perfect equilibrium cannot be guaranteed in all conditions, strict coordination cannot be taken as a principle for the reduction of strategy space. Moreover, empirical results suggest small deviations from coordination are common \parencite{freschet_explaining_2015}. The leaf economic spectrum being conserved at the intra-specific level \parencite{ hu_novel_2015} is another reason to include such trade-off as it would be a good basis for phenotypic plasticity \parencite{freschet_plasticity_2013}.\\


%Take home message ####################################
\textbf{The use of allocation trade-offs allows the construction of a generic multi-dimensional strategy space where a high diversity of species can potentially coexist. Because this space is based on physical laws, it ensures the non-existence of Darwinian demons and does not limit the species or individual plants to tested parameters and strategies. To be complete, the link between carbon pool allocation and physiology must be defined, respecting similar biological or physical laws.}

\section{Craft a trade-off: active and structural tissues}

Allocation trade-offs offer great flexibility and are easily understood and implemented. However, when they control the value of traits (SLA or SRL) involved in multiple processes, a balance must be found to avoid that: (1) one process is ignored because it has a low relative importance for fitness (becoming useless to the model), (2) the effects of processes involved show strong response curves to the allocation and there is only one global\sidenote{I use the term global here to designate the multidimensional space draw by the axis of interest and other variables play a role in involved process (e.g. resource availability, temperature etc...).} optimum. The idea behind a trade-off is that multiple positions are viable in different conditions or in association with other strategies. The leaf-economic spectrum, in addition to relying on the active-structural tissue trade-off, also requires "\textit{an evolutionary trade-off between leaf photosynthetic rates, construction costs, and leaf longevity}"\parencite{shipley_fundamental_2006}. This trade-off is explored in this section of the document.\\

In the framework of the model, plants share the same global parameters, as it should also be the case for photosynthesis parameters. Because photosynthesis relies on the exchange of gases ($CO_2$, $O_2$ and $H_2O$) and the interception of light, it is related to exchange area. Considering one shared parameter for maximum area-based potential exchange rate satisfies both the need for a shared parameter and a way for plants to varying their mass based exchange rate by changing their proportion of active tissues. This is in agreement with the LES that a strong relationship between mass-based traits and limited ones for area-based variables \parencite{wright_worldwide_2004}, and explain the first part of the trade-off between photosynthetic rate and construction cost. The second part is the relationship with the longevity. The longevity is often correlated to SLA in empirical studies, however, this is mainly explained by differences in tissue density and toughness than in thickness (another component of SLA). For this reason, we can directly link the leaf longevity to active tissue proportion. Respiration is also increased by the increase in the proportion of photosynthetic tissues \parencite{kleidon_global_2000, reich_world-wide_2014}. We have now a trade-off between a gain function (exchange area gain by changes in densities) and a cost function (tissue turn over and respiration). This should be enough to explain different strategies \parencite{westoby_leaf-height-seed_1998}. However, the model needs internal limits to avoid the gain function to lead to only active tissue organ (or only structural). These limits are required to allow individuals or species to change position along these axes (plasticity or strategic shift). The convex shape of gain function in association with a minimal cost (minimum turn-over cost above maximum potential gain) is enough to limit the allocation to structural tissues only. To avoid allocation to only active tissue, that would correspond to an organ made of protoplasts, the cost function needs higher than the potential gain. To achieve that an exponential function is chosen. This choice ensures that the potential gain function has an optimum different from the borders.\\


The tissue density is only one of the dimension of the SLA, and plants also vary their thickness in response to resource gradients \parencite{poorter_causes_2009}. For simplicity reason, only the density dimension will be considered in the model, while others tend to prefer only the thickness \parencite{feller_mathematical_2015}.



\paragraph{Gain as a function of conditions}

To allow diversity to emerge from temporal and spatial resource heterogeneity, the potential gain (productivity) of plants must be a function of both the plant strategy and the external conditions. While it makes no sense to have the productivity independent from the external conditions, if it is only driven by those, then the model is either a neutral model and the plasticity makes no sense in such model, or a model where only one strategy is the best, and plasticity would just allow the convergence toward this unique optimum phenotype. There must be different strategies dominating different habitats. 

This requirement is taken into account in the construction of the trade-off between the active and the structural tissues. The costs are mostly controlled by this allocation trade-off. The potential gain is not only a function of active tissue proportion but also depends on resource availability. Changes in resource level imply changes in the slope of gain function and a shift of the organ optimum for tissue allocation. This shift makes more conservative strategies more interesting when resources are scarce, while more exploitative allocation strategies are better for high resource availability. This link between optimum allocation and resource level could be used to define the best phenotype according to experience conditions, but the organ strategy cannot be disconnected from the whole plant strategy and allocation. %While there might be a function that links all possible resource availability combination (authorising plant life) with the best corresponding phenotypes, this function is not easy to compute because the whole plant scale must be considered\sidenote{the mutual dependence between the two organs makes the problem non obvious.} and such optimum may not correspond to an optimum in a more dynamic system.\\

The phenotype (within the subspace of vegetative allocation) depends both on the individual efficiency of organs and the balance between shoot and root activity. This balance often used to model plant plastic allocation and considered between light and nitrogen \parencite{soussana_gemini:_2012, lohier_explaining_2014}. In the context of mountain grasslands and global change, the water is more important and will certainly be more variable. The integration of nitrogen as a limiting solution would allow more functional diversity but complicates the optimisation problem that is the plasticity. 

% There you have to sell your memory stuff!

\subsection{Species memory and phenotype determination}\label{subsection:memory}


\paragraph{Vegetative phenotype axis}

As mentioned, the overall plant productivity is a function of three main \textemph{phenotypic axis}: the root mass fraction (RMF), the proportion of active tissues in roots (PAR], and the proportion of active tissues in the shoot (PAS). These three dimensions define a vegetative phenotypic space. The phenotypic plasticity consists of rules that drive the trajectories of the individual plants within this space to improve their performance relative to a fixed position. Modellers have to find a way to link the species-specific strategy with this starting point and the trajectories the plant can follow. This link is given by the concept of species memory of the species that translate the genetic information of the species in an information that have sense and can be manipulated.


\paragraph{Memory of species: a driving trait}

 In a non plastic context, the strategy and the phenotype are one thing, and there is no need (from the plant perspective) to associate this phenotype with the external conditions. In a plastic context, the phenotype, in addition to being linked to the overall plant strategy, is also linked to the external conditions (by the plasticity rules). There is a dependency between the plant strategy, its phenotype and the external conditions. In one direction, the conditions define an optimum phenotype (or phenotypic subspace) that best fits them. In the other direction, a phenotype corresponds to a set of favourable conditions and therefore contains these climatic conditions. This can be seen as the species \textemph{memory} of the conditions captured by mutation and selection processes. When the plant starts growing, it has no prior information on the external conditions yet but expresses a species-specific phenotype by default \sidenote{in a non plastic context, this phenotype is maintained over time.}. Because of the link between this phenotype and the external conditions, this starting phenotype can be expressed as a function of species strategy and expected conditions. The genetic information that defines the starting phenotype is partially expressed by the memory of the species and its strategy traits. It could be that the memory is enough to define the starting phenotype is there is an explicit function that links a set of conditions with an optimum phenotype. While this makes the concept of memory neater, it reduces a lot the possibility of diversity and supposes that evolutionary processes would have selected the best phenotype rather than the phenotypes that are able to maintain themselves. In \model, this partial constraint, defining a subspace rather than an optimum phenotype is illustrated by the control of the root mass fraction (RMF). The balance between the shoot and root activities being key in the overall plant performance, the RMF will be determined as a function of the species memory. The other strategy traits are defined independently and characterise the strategy of the species.
 
Because the phenotype is defined from this memory, the plasticity can then be imagined as a modification of the information given by the memory based on the experienced conditions. The plasticity is then a balance between this prior information contained in the species genetic information - the \textemph{memory} - and further information given by the conditions lived by the plant - the \textemph{experience} - leading to a posterior image of the conditions - the \textemph{estimation} - driving the trajectory of the plant within the phenotypic space.
 
 
 The concept of memory, in addition to link the starting phenotype/strategy with the plant trajectory/plasticity, also opens the door to the modelling of heritability by a meaningful alteration of this memory. If the experience of a plant does not match its species memory, it could change this value to transmit this information to new propagules.

%
%phenotype = ensemble of response trait values. Emerge from default trait + environment.\\
%Composite traits are defined by the interaction of different, independent, driving traits. What is a driving trait? Biology: genetic information. This genetic information is selected by climatic conditions. If we can make a link between optimum value for a trait and environmental conditions, then store external conditions and use the link between.\\

%

%Th example of the leaf trade-off and the importance of resource availability for optimum position.\\


%The coordination and the difficulty to define a phenotype\\


%Take home message ####################################
\textbf{The decomposition of organs organic matter in active and structural carbon pools makes a link between allocation and physiology and draws a subspace within the strategy space where individuals can move and change their phenotype. Limiting mechanisms restraint the viable options to realistic values along these axes. Within this space, the resource availability and external conditions play a major role in the expression of the strategy. The memory of the species offers a starting point for the phenotypic trajectories of plants driven by the plasticity rules that have to be defined.\\ %not convinced by this last part.
}


%Chapter take home message ####################################
\textbf{The identification of axes of strategic differentiation enables the definition of a strategy space for the modelling of species rich communities. The main resource-use strategies within this strategy space rely on established allocation trade-offs. Because they link physiological parameters with carbon pool sizes, these trade-offs allow to model contrasted plant behaviour in a realistic way. The effect of changes on allocation strategies on physiological processes can also be modelled thanks to this explicit link.}

\chapter{Modelling phenotypic plasticity}\label{chapter:modelling_PP}


\section{Plasticity as a strategy: between species memory and individual experience}

\subsection{A concept of active plasticity as a strategy}
\paragraph{The decomposition of plastic response}
The active plastic response is highly integrated \parencite{freschet_integrated_2015} and involve a lot of regulatory processes \parencite{nicotra_adaptive_2010}. It is impossible to represent all regulatory processes involved in an adaptive plastic response (APR) (because of our lack of knowledge and their complexity). Alternatively, the concept of \textit{integrated response} can be conceptualised. It supposes a link, or coordination, between the experienced conditions and the phenotypic response. This can be translated, in the model framework, by the existence of an explicit link between a representation of external conditions and a phenotype matching this conditions: the \textemph{allocation rule}\sidenote{the use of the word \textit{allocation} is justified here since the phenotypic plasticity in \model is reduced to changes in allocation.}. Another key work is \textit{anticipatory}. It supposes that the plant knows, or at least have an idea of the future conditions. This is really the point of an active plastic response: change the phenotype to better match future conditions. A representation of future is also called a \textemph{projection}. The projection and the allocation rule together form the active plastic response.\\
If allocation rule is not obvious and is discussed later(see paragraph \ref{section:allocation-rule}), the idea of projection is fairly intuitive. The projection will correspond to a value for a given metric that represents the external conditions. It can be resource availability level, temperature, herbivory risk, etc... If such metrics can be given at the community scale, it makes sense to use a plant-centred measure of these variables for two reasons: (1) take into account the spatial heterogeneity, (2) plant experience of conditions is necessarily egocentric. The details on how experienced conditions are interpreted by plants in \model are described in section \ref{chapter:model-description}.

\paragraph{Control of plasticity}
Active plasticity is now represented by a projection and an allocation rule. However, how a species can control the whole process is unclear. In theory, both projection and allocation rule can be species-specific. In nature, plants generally have structurally similar regulatory processes\sidenote{see box in section \ref{part:literature} \ref{chapter:PP_ISV}.} and responses to external stimuli are translated (and stored temporarily) thanks to the accumulation of chemical compounds. These mechanisms suggest that, while the allocation rules are mainly shared, individuals vary on the information level (i.e. the concentration of phytohormones), or in the context of the model: plant vary in projection. This control of active plasticity is supported by the model design. The number of rules that can drive the allocation is reduced and discrete, while the projection is multi-dimensional (one dimension per external variable considered), continuous and highly flexible with a reduced number of parameters\sidenote{details in paragraph \textit{estimation of conditions} in section \ref{chapter:model-description}.}.
For this reason, \textemph{projection} is chosen to be the \textemph{controlling factor} of active plasticity, while the allocation rule is fixed and shared between all species. Therefore an individual with fixed projection won't be actively plastic, despite the fact that it could express apparent plasticity because of external factors: reduced resource availability, grazing, frost damage, etc... The model has now a concept for active plastic response\sidenote{In the rest of the document terms \textit{plasticity} or \textit{phenotypic plasticity} will refer to an \textit{active plastic response}.} controlled by the projection of external condition. The next question that needs to be answered is: how do species differ in their plastic response ?\\

\subsection{Species specific plasticity: the balance between the species memory and the individual experience}

\paragraph{Species specific plasticity}

In \model, the projection of external conditions is the means for plants to alter their phenotype in response to changes in experienced conditions. Since the allocation (or driving) rule is shared by all plants, if the projection of external conditions is also shared by all plants, then is the response still active plasticity? The first intuitive answer is \textit{yes} since the conceptual framework is respected and plants would react to changes in conditions that would affect the projection. But, such response would be equivalent to a direct external control of the climate on the phenotype. In such case, species would not have control over how the phenotype varies, that would be fully controlled by shared projection and shared allocation rule. This is passive plasticity. To have proper active plasticity, the species need to be able to \textemph{regulate} the plastic response. If species can regulate plastic response thanks to species-specific parameters, plasticity becomes a \textemph{strategy}. This is in agreement with Bradshaw's vision of phenotypic plasticity as a trait, or a character, subject to selection and evolutionary processes\parencite{bradshaw_evolutionary_1965, bradshaw_unravelling_2006}. How do species regulate the plastic response to make it a strategy?\\

Therefore, to have a proper \textemph{strategic plasticity}, the plants need to control the plastic response, so in \model to control the projection. This modification of the projection makes the specificity of the plastic response and allows diversity in plasticity. 
%\textbf{Plasticity}: expected environment -> phenotype, here phenotype is equivalent to biomass partitioning, that means expected environment -> allocation coefficients. Then memory -> expectations -> allocation. Because low dimensions, and we want diversity, and the link between memory and allocation might not be a function (one memory give exactly one optimum allocation), in the model this relationship is not verified. Species-specific traits are used to allow for different strategies to be associated with the same memory (different plants won't have the same strat, despite sharing the projection)\\
%Once the plasticity is introduced, talk about the memory. Now you can also talk about the mapping/consistency between both and the difficulties to use both.



%\paragraph{Build a projection}
\paragraph{Species memory and individual experience}
The projection is the way plants control phenotypic plasticity. A projection is an idea of the future based on available information and on the understanding of a phenomenon. Ones could discuss what is the understanding of the climate by plants, while others can focus on how to represent such understanding and state that fine molecular regulatory processes can reproduce and store such information. The focus is on the construction of the projection with respect to the different sources of information a plant has: (1) its experience of climate and external factors, and (2) its ancestors' memory\sidenote{see paragraph \ref{subsection:memory}.}.\\
While, for any given individual plant, the experience of external conditions varies in time, the memory stays fixed. There is a clear contrast between the variable experience of conditions and the fixed species memory. A way to represent different strategies and the level of control the plant apply on projection is to vary, between species, the relative weight of species memory against individual perception. This species-specific parameter, the \textemph{confidence in species memory}, sets the \textemph{stability} of the projection with respect to individual experience. The capacity to adapt the phenotype to changing conditions is directly linked to the projection changes. High confidence in species memory translates in a low amplitude of projection variations, and though in low active plasticity.\\
The calculation of projected resource availability levels, or temperatures, are detailed in the dedicated paragraph of the model description. The key message is that the species has control on plasticity with both its confidence in species memory and the said memory that alters the projection. %The relative impact of memory and confidence is described in figure \ref{fig:memory-confidence}.

% The species-specific memory of external condition has been described\sidenote{paragraph \ref{subsection:memory}} as a way to match certain traits (mainly root:shoot ratio) with external conditions. The memory is a metric of resource availability that is used to partly (potentially entirely) determine the phenotype of plants.


\section{Driving rules of allocation}\label{section:allocation-rule}

\textemph{Allocation rules} are determinant in the model behaviour as it is shared by all species, and link the projection of conditions with the phenotype. The objective of the allocation is to define the target phenotype for a given individual while considering the information about the external environment and the state of the individual. It has been established that the current model will rely on a projection of the conditions to establish such target phenotype. Therefore, the allocation rule characterises the mathematical link between this projection, the current state of the individual and the target phenotypes. The definition of the target phenotype resides in the solving of the system defined by the allocation rule, the projection and the individual state. Depending on the allocation rule, the system can be strongly constrained by the allocation rule, reducing the number of solution, but also leading to strong convergence between individuals sharing the same projection, and difficulties to model diverse communities. Alternatively, a less constrained link between the projection and potential target phenotype would define a sub-space solution rather than an unique solution. An addition rule is then required to define the target phenotype. This additional rula can be function of the individual state (\textit{i.e.} phenotypic distance) reducing the convergence between individuals and allowing more diverse communities. While the allocation rules can have strong effects on the plastic behaviour of modelled plants, the main objective of these rules should be to improve fitness. Comparison to empirical pattern should allow us to test the validity of such rules.

%\textemph{Allocation rules} are determinant in the model behaviour as it is shared by all species, and link the projection of conditions with the phenotype. Multiple options are possible to drive plasticity, but they can be divided into two main categories: (1) determining, (2) directive. Function from the first category defines an optimum phenotype (within the plastic strategy space), while functions from the latter group defines an optimum sub-space and other criteria (than the  are needed to determine the exact new phenotype.\\
%The two type of rules have different strengths and weaknesses that are detailed in table \ref{table:allocation_rules}

%\begin{table}
%\caption{Two types of allocation rules: strengths and weaknesses} 
%\label{table:allocation_rules}
%\begin{center}%
%\begin{tabular}{l c r}
%Strength or weakness & Determining & Directive \\ 
%\hline 
%Phenotype fully determined & \textcolor{myGreen}{$\bullet$} & $\circ$ \\
%Risk of convergence & $\bullet$ &  $\circ$ \\
%Reduction of functional diversity & $\bullet$ &  $\circ$\\
%Discrepancy between parameters & $\bullet$ &  $\circ$\\
%Strong plasticity effect & \textcolor{myGreen}{$\bullet$} & $\circ$
%\end{tabular} 
%\end{center}
%\vspace*{0.5cm}
%\end{table}


One of the assumptions of the plasticity developed in this document is the existence of a tight relationship between experienced condition and fitness. A subsidiary assumption in the implementation of this plasticity is that this function can be captured, or modelled, by the same functions that drive plant growth. In other words, simulating individual growth, using the estimated/projected conditions as parameters, day by day, is enough to capture the link between environmental conditions (experienced by the focal plant) and plant growth\sidenote{that takes here the value of fitness proxy}. 

A determining allocation rule would try to explicit this link function and optimise it. In other words, find the phenotype that maximises the gain function. While evolutionary processes allow the integration over time of the effects of phenotypic changes, it is not possible to consider this dimension without a long-term projection of the conditions. So the temporal dimension is excluded, and the maximisation of the daily gain is hypothesised to maximise the gain over time. On the other hand, a directive function would identify a subset of acceptable phenotypes. Then, an additional selection function is required to select the target phenotype within this subset. A sensible criterion of selection is to consider the distance between the current and the alternative phenotypes to select the target one. The elements around the choice of the gain functions, determining the optimum phenotype or subset, and the eventual selection function are discussed in the following description of the model.

%Take home message ####################################
\textbf{The driving rule of plasticity defines whether or not the choice of the phenotype is fully determined by the projection of external conditions or also constrained by some species-specific parameters. The effect of this balance between projection and parameters has a large influence on the model behaviour. In any case, the projection is the main control on individual plastic response to change in conditions, offering possibilities to modulate individual plasticity despite an allocation rule shared by all species. The role of both projection and allocation rule will of particular interest during the analysis of the impact of phenotypic plasticity of plant growth and community dynamics.}

\paragraph{The paradox of plasticity}

While the representation of plasticity as a strategy increases both model potential species diversity and potential diversity of response \parencite{ ryser_consequences_2000, kichenin_contrasting_2013}, plasticity itself may reduce diversity. Indeed, plasticity lead to changes in phenotype in response to condition changes, while these phenotypic changes are unlikely to be identical for all individuals, their general convergence points will probably be similar. Plasticity is a mechanism that is likely to contract the space of expressed values for plastic traits. Therefore, it is hard to analyse the effect of plasticity on functional diversity without disentangling the direct effect on the expressed trait values, and the indirect effect of changes in performance and interactions. Nonetheless, some external mechanisms\sidenote{impacting the drivers of plastic response, not the response itself} can prevent convergence of phenotype: (1) changes in competitive hierarchy may lead to differences in individual experience of conditions, (2) specificity of the external driver, e.g. selective herbivory of more digestable species, (3) diversity of position of the target phenotype. \\
Asides from these external mechanisms, there are internal controls of active plastic response: the projection and the plastic allocation mechanisms. It is easy to imagine numerous projections and allocation mechanisms, however, they are susceptible of emerging only if they have a positive impact on fitness overall. Considering the diversity of plastic response is a research question in itself, and I will not try to answer it in this document. Nevertheless, the progress in the understanding of the effect of plasticity on performance and potential diversity this work provide will certainly help further work in that direction. In this context, the use of species-specific control over the projection of conditions is already a step forward and prevent total convergence\sidenote{in addition to directive allocation mechanisms, see below subsection \ref{section:allocation-rule}}. Indeed, without considering multiple allocation algorithms within the same community, having the plasticity as a strategy \parencite{bradshaw_unravelling_2006} (controlled by a species-specific trait, as opposed to many existing individual-based-models) allows interesting questions to be addressed. The question of the cost of plasticity is central in the understanding of this mechanisms \parencite{dewitt_costs_1998, auld_re-evaluating_2009}, and could lead to mechanisms of co-selection between resource use or reproductive strategies with plasticity strategies. The first step in this direction consists in looking at how plasticity can have different impacts on the performance of species with different strategies (conservative versus exploitative).



%Or can a plant be plastic and unique? The paradox of plasticity and diversity.\\
%Plastic will necessarily reduce the space (as there is convergence, unless different strategies of adaptation).\\

 %Because the plasticity is a strategy and not a default behaviour, its effects on individual performance have to be tested. But it also opens a lot of interesting questions about the costs and benefits of plasticity, and the co-selection with the resource use strategy.\\
%Moreover, this particular implementation of plasticity limits risks of convergence while allowing plants to evolve in the strategy space defined earlier.

\subsection{On the difficulty to match strategy and conditions.}\label{subsection:match}

\paragraph{Why match phenotype to memory}

As mentioned in the previous section, the framework of plasticity developed in this document relies on a strong link between condition estimation and the phenotype, that is supported by the assumption that similar link exists between condition experienced by the focal plant and its fitness. If this assumption is correct, then the initial phenotype (or default phenotype) should match the optimum phenotype defined by this link expressed by the allocation rules and the species-specific memory of conditions. Otherwise, an artificial phenotypic drift could be observed: the phenotype could change to meet the optimum defined by the allocation rule, without any change in the projection of the conditions. This could allow modelling ontogenetic shift but complicates the computation of plasticity costs and the analysis of the effects of the plasticity. One main difficult emerges here: because the processes involved in plant growth are numerous and complex, it is not possible to determine analytically what phenotype is the best (considering the memory of conditions). This point is discussed in the following paragraph as the understanding of the component of plant performance is a first step to understand the model's behaviour and plasticity mechanisms. Ones could compute the convergence phenotype for a given memory of external conditions for each possible memory combinations, and map the phenotype to the memory.
This solution is a good alternative to an analytical solution when the later is not possible, but it comes with the disadvantage of a very high computational cost that is prohibitive for calibration procedures.
When an allocation rule is the only directive, defining a starting phenotype is easier because an ensemble of phenotype satisfies the coherence between the memory and driving rule.

Limiting the plasticity costs and adding additional steps to reduce the phenotypic drift should allow the exploration of the different allocation rules and the effect of the phenotypic plasticity.
%
%In a  lies a difficulty, indeed, the design of the model favours modularity but different allocation algorithms do not share the same constraints.
%
%\begin{itemize}
%\item why having default traits even if they do not match the optimum defined by the allocation rule;
%\itel the difficulty to determine an optimum phenotype analytically.
%\end{itemize}
%
%\paragraph{Efficiency and performance}
%Complexity between organ, overall efficiency, and equilibrium. Try to formalise each function and show the link between these elements.
%
%\paragraph{Is performance fitness?}
%
%The multi-dimensionality of fitness.\\
%
%Fitness and competition: where niche theory and coexistence theory coexist \parencite{letten_linking_2017}

 
 
%Take home message ####################################
\textbf{The projection of external conditions, driving the plastic allocation of organic matter, lies on a balance between species memory and individual experience. Its design makes of plasticity an axis of strategic differentiation alongside the other strategy axes. Thanks to this innovative design, the model can be used to examine the ecological relevance of plasticity in different conditions and in association with different strategies. The effect of allocation rules and projection stability can be explored independently or conjointly for a better understanding of the relative importance of allocation and plasticity.}
% It is possible to explore independently or conjointly the effect of allocation rules and projection stability on individual and community dynamics.




\chapter{ODD description of the model \model}\label{chapter:model-description}

\input{./2_PP/model_description}
%\section{Model overview}
%\paragraph{pseudo-code and routine}
%\paragraph{allocation}
%mechanism and stochasticity\\
%5 types of allocation\\


%Take home message ####################################

%
%\subsection{Concepts}
%\paragraph{Memory} Genetic memory (see Sonia Sultan book for references). Selection and evolutionary processes.
%\paragraph{Equilibrium and efficiency}
%\paragraph{Optimum, strategy and memory} There might be optimum. But not easy to compute, especially when you consider more complex cost and interactions. Depend on different efficiencies and equilibrium... Also, you may want to avoid efficient by risky strategies (if you wrong, or if there is a quick shift). Need for strategic traits to drive allocation more than memory.\\
%Ok but what happen with optimisation allocation ? -> need the strategy to be tightly linked to memory. But that part has requirements: memory is a reliable source for strategy. Ultimately the resource availability is only one (ok, maybe two) dimension to phenotype optimisation. This strategy trait is necessary as other aspects of fitness are ignore (temperature implemented but not tested, grazzing vulnerability, frost damade, WUE, CO2 etc...) If you multiply mechanisms affecting the fitness you complexify the fitness landscape and allow for multiple strategies to be explored. Otherwise you must aartifically constraint. \\
%
%\indent \textbf{This is crucial to discuss this important aspect of strategic differenciation emerging for processes and how plant change strategy as the projection of environment evolves. Memory then plays more a role of sensitivity (with tau).}\\
%But for the moment the partial implementation of that through the artificial but meant to disappear default strategy is making analysis and assumptions difficult. Ok, but how do you treat it ? 
%
% equilibrium, resource use, resource availability, condition estimation
%\paragraph{Condition estimation}
%Important role of condition estimation. Perception mechanisms. (cost). Difference between plasticity and acclimation and epigenetics. 
%
%\subsection{Implementation}
%Why the use of a sampling method: complex effect of allocation and complex allocation system that is meant to be extended. Some results on the stability of phenotypes. How sampling method can drive the allocation.
%
%
%\section{Perturbations and resistances}
%
%\subsection{Climate}
%
%\subsection{Management}



%Take home message ####################################


%
%\subsection{comparison of different algorithms}
%full plasticity : freschet 2015 in poorter \& Ryser 2015
%the two sides of the performance/fitness: equilibrium and tissue efficiency\\
%age vs biomass.
%
%\section{Community dynamics parametrisation}
%Obj: demonstrate that the model is able to reproduce community dynamics (as it was designed for).\\
%Find parameters that allows coexistence (suggest plasticity should allow a diversity of strategy). SLA and height data. Phytosociology for 10m quadrats.
