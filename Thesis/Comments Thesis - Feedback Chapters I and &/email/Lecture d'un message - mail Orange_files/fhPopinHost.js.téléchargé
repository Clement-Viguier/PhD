function fhPopin(a){"use strict";function b(){for(var a=navigator.userAgent.toLowerCase(),b=["ipad","iphone","ipod"],c=0;c<b.length;c++)if(-1!==a.indexOf(b[c]))return!0;return!1}function c(){var a=navigator.userAgent.toLowerCase(),b=a.indexOf("android")>-1;return b?!0:!1}function d(){if(!navigator.userAgent)return!1;var a=/Android ([\d+\.]{3,5})/gi,b=a.exec(navigator.userAgent);return b&&b[1]?parseFloat(b[1]):!1}function e(){return"MSIE"===navigator.sayswho.name?navigator.sayswho.mainVersion<9?!1:!0:"Firefox"===navigator.sayswho.name?c()?!0:navigator.sayswho.mainVersion<17?!1:!0:"Chrome"===navigator.sayswho.name?navigator.sayswho.mainVersion<17?!1:!0:"Opera"===navigator.sayswho.name?navigator.sayswho.mainVersion<15?!1:!0:"Safari"===navigator.sayswho.name?navigator.sayswho.mainVersion<6?!1:!0:!1}function f(){return b()?"Safari"!==navigator.sayswho.name&&navigator.sayswho.mainVersion<6?(k(!0),!1):!0:c()?(d()>=4||"Firefox"===navigator.sayswho.name)&&e()?!0:(k(!0),!1):e()?!0:(k(!1),!1)}function g(a,b){var c,d=b.length;for(c=0;d>c;c++)if(b[c]===a)return!0;return!1}function h(a,b,c){var d,e=a.className,f=e.split(" "),g=c===!0?b+" ":"";for(d in f)f.hasOwnProperty(d)&&f[d]!==b&&(g+=f[d]+" ");"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),a.className=g.trim()}function i(){var a=document;if(!a.getElementById(F)){var b=a.createElement("link"),c=D+E;b.setAttribute("rel","stylesheet"),b.setAttribute("href",c),b.setAttribute("id",F),a.getElementsByTagName("head")[0].appendChild(b)}}function j(){var a=document;if(!a.getElementById(G)){var b=a.createElement("div");b.setAttribute("id",G),b.className=H,b.innerHTML='<div id="'+Y+'" class="'+Z+'"></div><div id="'+O+'" class="'+P+'" style="display:none";><div id="'+Q+'" class="'+R+'" role="dialogue" aria-label=""><div id="'+W+'" class="'+X+'"><div class="'+I+'"><button class="'+J+'" onclick="window._fhFrames.current.closeByCross();"><span id="'+ha+'" class="'+ia+'">'+K+'</span></button></div></div></div><div role="alert" aria-live="assertive" aria-hidden="true" id="'+S+'" class="'+T+" "+H+'"><h2 id="'+fa+'" class="'+ia+'"></h2><div class="'+U+'"></div><div class="'+V+'" id="'+ea+'"></div></div><div id="'+$+'" class="'+_+" "+H+'"></div><div class="'+L+'"></div></div>',a.body.appendChild(b)}}function k(a){if(document.getElementById(G))document.getElementById(G).style.display="inline-block";else{var b=document.createElement("div"),c="";if(a)c="<h2>La version de votre OS ne vous permet pas de profiter pleinement du service contact.</h2><p>Mettez à jour celui-ci.<br/>Liste des versions recommandées : Android 4 et +, IOS 6 et +</p>";else{switch(c="<h2>Votre version de "+("MSIE"!==navigator.sayswho.name?navigator.sayswho.name:"Internet Explorer")+" ne vous permet pas de profiter pleinement du service contact.</h2><p>Mettez à jour votre navigateur.<br/>",navigator.sayswho.name){case"MSIE":c+='<a href="http://windows.microsoft.com/fr-fr/internet-explorer/download-ie-MCM">Internet Explorer 9 et +</a>';break;case"Opera":c+='<a href="http://www.opera.com/fr">Opera 15 et +</a>';break;case"Firefox":c+='<a href="http://www.mozilla.org/fr/firefox/">Firefox 17 et +</a>';break;case"Chrome":c+='<a href="http://logicielsgratuits.orange.fr/adventurer/presentation/">Adventurer</a>';break;case"Safari":c+='<a href="http://www.apple.com/fr/safari/">Safari 6 et +</a>';break;default:c='<h2>Votre version de votre navigateur ne vous permet pas de profiter pleinement du service contact.</h2><p>Mettez à jour votre navigateur.<br/>Liste des navigateurs recommandés : <a href="http://logicielsgratuits.orange.fr/adventurer/presentation/">Adventurer</a>, <a href="http://www.mozilla.org/fr/firefox/">Firefox 17 et +</a>, <a href="http://windows.microsoft.com/fr-fr/internet-explorer/download-ie-MCM">Internet Explorer 9 et +</a>, <a href="http://www.opera.com/fr">Opera 15 et +</a>, <a href="http://www.apple.com/fr/safari/">Safari 6 et +</a>'}c+="</p>"}b.setAttribute("id",G),b.innerHTML='<div id="'+Y+'" class="'+Z+'"></div><div id="'+O+'" class="'+P+'"><div role="alert" aria-live="assertive" id="'+S+'" class="'+T+' fh_popin_confirm_status_ko "><div class="'+I+'"><button class="'+J+'" onclick="window._fhFrames.current.closeCompatibility();"><span id="'+ha+'" class="'+ia+'">'+K+'</span></button></div><h2 id="'+fa+'" class="'+ia+'">Incompatibilité Navigateur</h2><div class="'+U+'"></div><div class="'+V+'" id="'+ea+'">'+c+'</div></div><div id="'+$+'" class="'+_+'"></div><div class="'+L+'"></div></div>',document.body.appendChild(b)}}function l(a){var b=[];try{b=JSON.parse(a.data)}catch(c){}switch(b.frame=b.frame||M,b.action){case"resize":var d=document.getElementById(M);b.data.size+oa<na?d.style.height=b.data.size+oa+"px":d.style.height=na+"px";break;case"complete":m(la[window._fhFrames[b.frame].getServicePopin()].url,"loaded",M);break;case"loaded":ra=!0;break;case"close":m(la[window._fhFrames[b.frame].getServicePopin()].url,"preparetoclose",b.data,b.frame);break;case"readytoclose":u(b.frame);break;case"connectivity":n(b.data,b.status);break;case"infos":m(la[window._fhFrames[b.frame].getServicePopin()].url,"infos",A,b.frame);break;case"confirm":x(b.frame),q(Q),o(b.status,b.data,b.frame);break;case"add":x(b.frame),window._fhFrames[b.frame].parent?p(window._fhFrames[b.frame].parent):q(G),b.status?window._fhFrames[b.frame].callCallback("add","success",""):window._fhFrames[b.frame].callCallback("add","error",b.data);break;case"get":switch(window._fhFrames[M].callService){case"webmail":var e=location.protocol+"//"+location.host+location.pathname;"'"===e.charAt(e.length-1)&&(e=e.substring(0,e.length-1));var f="POST",g=document.createElement("form");g.setAttribute("id","confirmParameter"),g.setAttribute("name","confirmParameter"),g.setAttribute("method",f),g.setAttribute("target","_parent"),g.setAttribute("action",location.protocol+"//"+location.host+location.pathname+"?RELOAD=OK");var h=document.createElement("input");h.setAttribute("type","hidden"),h.setAttribute("name","urlback"),h.setAttribute("value",location.protocol+"//"+location.host+location.pathname+"?RELOAD=OK"),g.appendChild(h);var i=document.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","nbcookie"),i.setAttribute("value","1"),g.appendChild(i),document.body.appendChild(g),g.submit();break;case"WebXMSFront":location.reload()}x(b.frame),window._fhFrames[b.frame].parent?p(window._fhFrames[b.frame].parent):q(G),window._fhFrames[b.frame].callCallback("get","success",b.data);break;case"openContact":s(b.frame,b.data,"contact","get");break;case"openXmsGallery":s(b.frame,b.data,"gallery","gallery")}}function m(a,b,c,d){var e=d||M,f=document.getElementById(e).contentWindow,g={};g.callService=window._fhFrames[e].callService,g.action=b,g.data=c,f.postMessage(JSON.stringify(g),window.location.protocol+a)}function n(a,b){var c=document.getElementById($);"ok"===b?(c.style.right="-150px",setTimeout(function(){q(c)},1e3)):"ko"===b&&(c.innerText?c.innerText=a:c.textContent=a,p(c),setTimeout(function(){c.style.right="0px"},10))}function o(a,b,c){var d=document,e=d.getElementById(S),f=d.getElementById(ea),g=d.getElementById(fa);"ok"===a?(h(e,ga+"ko",!1),h(e,ga+"ok",!0)):"ko"===a&&(h(e,ga+"ok",!1),h(e,ga+"ko",!0)),e.innerText?(f.innerText=b.text,g.innerText=b.acc):(f.textContent=b.text,g.textContent=b.acc),C&&p(e),setTimeout(function(){if(q(e),p(Q),q(G),window._fhFrames[c].callCallback("add","ok"===a?"success":"error",""),"ok"===a)switch(window._fhFrames[M].callService){case"webmail":var b=location.protocol+"//"+location.host+location.pathname;"'"===b.charAt(b.length-1)&&(b=b.substring(0,b.length-1)),window.location.href=b+"?FOLDER=SF_INBOX"}},2e3)}function p(a){"object"!=typeof a&&(a=document.getElementById(a)),h(a,H,!1),a.setAttribute("aria-hidden",!1)}function q(a){"object"!=typeof a&&(a=document.getElementById(a)),h(a,H,!0),a.setAttribute("aria-hidden",!0)}function r(a,b,c){var d=document;if(!d.getElementById(M)&&null!==b){window._fhFrames.current=window._fhFrames[M];var e=d.createElement("iframe"),f=la[a].url,g=window.location.protocol+f+b;qa||(window.addEventListener?(window.addEventListener("message",l,!1),window.addEventListener("keydown",t,!1)):(window.attachEvent("onmessage",l),window.attachEvent("onkeydown",t))),e.onload=function(){m(f,"loaded",M)},e.setAttribute("src",g),e.setAttribute("id",M),e.setAttribute("class",N),d.getElementById(W).appendChild(e),p(G)}}function s(a,b,c,d){q(a),window._fhChildPopin=new fhPopin(a);var e=function(a){p(G),p(a.frame),m(la[window._fhFrames[a.frame].getServicePopin()].url,"childCallback",a,a.frame)};window._fhChildPopin.open(b,c,d,e)}function t(a){27===a.keyCode&&window._fhFrames.current.closeByCross()}function u(a){if(x(a),window._fhFrames[a].parent){var b=window._fhFrames[a].parent;p(b)}else q(G);window._fhFrames[a].callCloseCallBack(),y="",z=""}function v(a,b,c,d,e,f,i){if(a&&g(a,ka)&&c&&g(c,ma)&&document.getElementById(G)){var j=[];for(var k in la[c].type)la[c].type.hasOwnProperty(k)&&"string"==typeof k&&j.push(k);if(g(b,j)){window._fhFrames[M].callService=a,y=e,A=d,B=c,z=f,C=!0,"boolean"==typeof i?C=i:"boolean"==typeof z?C=z:"boolean"==typeof e?C=e:"boolean"==typeof d&&(C=d),pa.fr[c][b]?document.getElementById(ha).innerHTML=pa.fr[c][b]:document.getElementById(ha).innerHTML=K;var l=document.getElementById(Q);h(l,aa,!1),h(l,ba,!1),h(l,ca,!1),h(l,da,!1),"large"===la[c].type[b]&&"add"===b?h(l,ca,!0):"medium"===la[c].type[b]&&"add"===b?h(l,da,!0):"large"===la[c].type[b]?h(l,aa,!0):"medium"===la[c].type[b]&&h(l,ba,!0);var m=w("mockXms"),n=w("userType");""!==m&&""!==n?r(c,"/popin/"+b+".php?mock=true&userType="+n):r(c,"/popin/"+b+".php")}}}function w(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(2===e.length&&e[0]===a)return e[1]}return""}function x(a){var b=document,c=b.getElementById(a),d=b.getElementById(W);c&&d&&(window._fhFrames[a].parent?(window._fhFrames.current=window._fhFrames[window._fhFrames[a].parent],delete window._fhChildPopin):(window.removeEventListener?(window.removeEventListener("message",l,!1),window.removeEventListener("keydown",t,!1)):(window.detachEvent("onmessage",l),window.detachEvent("onkeydown",t)),window._fhFrames.current={}),d.removeChild(c))}var y="",z="",A="",B="",C=!0,D="//static.fresh.woopic.com/current/popin/G0R3C0P1/css/",E="fh_popin.css",F="fh_popin_css",G="fh_popin",H="fh_popin_hide",I="fh_popin_header_close",J="fh_popin_header_close-btn",K="Fermer la fenêtre",L="fh_popin_place",M="fh_popin_iframe",N="fh_popin_iframe",O="fh_popin_wrapper",P="fh_popin_wrapper",Q="fh_popin_message",R="fh_popin_message",S="fh_popin_confirm",T="fh_popin_confirm",U="fh_popin_confirm_pic",V="fh_popin_confirm_txt",W="fh_popin_content",X="fh_popin_content",Y="fh_popin_back",Z="fh_popin_back",$="fh_popin_connectivity",_="fh_popin_connectivity",aa="fh_popin_message-large",ba="fh_popin_message-medium",ca="fh_popin_message-add-large",da="fh_popin_message-add-medium",ea="fh_popin_confirm_text",fa="fh_popin_confirm_acc",ga="fh_popin_confirm_status_",ha="fh-close-popin",ia="fh_accessibility-el",ja=!1,ka=JSON.parse("{\"service\" : [\"mailv3\", \"webmail\", \"WebXMS\", \"WebXMSFront\", \"pperso\", \"agenda\", \"cloud\", \"occ\", \"occmail\", \"occphone\", \"contact\", \"webmucinq\"]}").service,la=JSON.parse("{\"contact\": {\"url\": \"//mescontacts.orange.fr\", \"type\": {\"add\":\"medium\", \"get\":\"large\", \"vcard\":\"medium\"}},\"webxms\": {\"url\": \"//smsmms.orange.fr\", \"type\": {\"compose\":\"large\"}},\"gallery\": {\"url\": \"//fresh-webxms.orange.fr\", \"type\": {\"gallery\":\"large\"}}}"),ma=[],na=430,oa=35,pa={fr:{contact:{add:"annuler l'ajout à contacts",get:"annuler la sélection de contacts",vcard:"annuler l'ajout à contacts"},webxms:{compose:"annuler l'envoi de sms"},gallery:{gallery:"annuler la recherche d'images"}}},qa=a||!1,ra=!1;if(ja===!1){window._fhFrames||(window._fhFrames={}),qa&&(M+="_from_"+qa),window._fhFrames[M]=this,qa&&(window._fhFrames[M].parent=qa),window._fhFrames.current=this,i();for(var sa in la)la.hasOwnProperty(sa)&&"string"==typeof sa&&ma.push(sa);ja=!0}var ta=function(){document.getElementById(O)&&(document.getElementById(O).style.display="block")};window.addEventListener?window.addEventListener("load",ta,!1):window.attachEvent("onload",ta),navigator.sayswho=function(){var a,b,c,d=navigator.userAgent,e=d.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(e[1])?(c=/\brv[ :]+(\d+(\.\d+)?)/g.exec(d)||[],a="MSIE",b=c[1]):(e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"],null!==(c=d.match(/version\/([\.\d]+)/i))&&(e[2]=c[1]),a=e[0],b=parseInt(e[1],10),"Safari"===a&&(b=Math.round(100*parseFloat(e[2]))/100)),{name:a,mainVersion:b}}(),this.callCallback=function(a,b,c){if(y&&"function"==typeof y){var d={};d.action=a,d.status=b,d.data=c,window._fhFrames[M].parent&&(d.frame=window._fhFrames[M].parent),y(d)}y="",z=""},this.callCloseCallBack=function(a,b,c){z&&"function"==typeof z&&z(),z="",y=""},this.open=function(a,b,c,d,e,g,h){f()&&(j(),ta(),v(a,c,b,e,d,g,h),window.scrollTo(0,0))},this.close=function(){u(M)},this.closeByCross=function(){ra?l({data:'{"action":"close","status":"", "data":"closeBtn", "frame":"'+M+'"}'}):u(M)},this.closeCompatibility=function(){document.getElementById(G).style.display="none"},this.getServicePopin=function(){return B}}var _fhPopin=new fhPopin;