threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[4:7]), parameters = pp)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
ggplot(full_perfs, aes(Var1, Var3)) + geom_point(aes(colour = BM_ag + BM_bg)) + facet_wrap(~Var2)
ppot <- pot_simulation()
ppot
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(threeDspace[10,4:7]), parameters = pp)
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(threeDspace[10,4:7]), parameters = pp)
threeDspace[10,4:7]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(threeDspace[10,c(1,2,6,7)]), parameters = pp)
sp[10,c(1,2,6,7)]
threeDspace[10,c(1,2,6,7)]
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(threeDspace[11,c(1,2,6,7)]), parameters = pp)
pp
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(threeDspace[10,c(1,2,6,7)]), parameters = pp)
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = as.vector(threeDspace[10,c(1,2,6,7)]), parameters = pp)
as.vector(threeDspace[10,c(1,2,6,7)])
dim(as.vector(threeDspace[10,c(1,2,6,7)]))
unlist(threeDspace[10,c(1,2,6,7)])
dim(unlist(threeDspace[10,c(1,2,6,7)]))
ppot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = unlist(threeDspace[10,c(1,2,6,7)]), parameters = pp)
ppot
n <- 4
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
ggplot(full_perfs, aes(Var1, Var3)) + geom_point(aes(colour = BM_ag + BM_bg)) + facet_wrap(~Var2)
n <- 12
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
n <- 10
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
ggplot(full_perfs, aes(Var1, Var3)) + geom_point(aes(colour = BM_ag + BM_bg)) + facet_wrap(~Var2)
ggplot(full_perfs, aes(Var1, Var3)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~Var2)
ggplot(full_perfs, aes(Var1, Var3)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~Var2)
head(full_perfs)
colnames(full_perfs)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs, aes(P_act_shoot, P_act_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~Var2)
colnames(full_perfs)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs, aes(P_act_shoot, P_act_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_root)
ggplot(full_perfs, aes(P_act_shoot, P_act_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_root)
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs)[7]]
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs)[7]]
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs)[7]
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs)[7],]
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
full_perfs_r
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[7],]
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)
unique(full_perfs$P_act_shoot)
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus)) + scale_colour_manual(values = c("grey70", "orange"))
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs$P_act_shoot == unique(full_perfs$P_act_shoot)[7]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus)) + scale_colour_manual(values = c("grey70", "orange"))
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[7],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs$P_act_shoot == unique(full_perfs$P_act_shoot)[7]] <- T
T
full_perfs_r$focus[full_perfs$P_act_shoot == unique(full_perfs$P_act_shoot)[7]]
full_perfs_r$focus
full_perfs_r$focus <- F
full_perfs_r$focus
full_perfs$P_act_shoot == unique(full_perfs$P_act_shoot)[7]
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[7]] <- T
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus)) + scale_colour_manual(values = c("grey70", "orange"))
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange"))
n <- 15
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
colnames(full_perfs)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[7],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[7]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange"))
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[7])
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[11],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[11]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[11])
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass()
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1), colour = "grey70") + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[11], colour = "orange")
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[11], colour = "orange")
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass()
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[11],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[8]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange")
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass()
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot), xlim = c(0,1)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass()
ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + ggpar(xlim = c(0,1))
grid.arrange(p1, p2, labels = c("A", "B"), ncol = 2)
library(gridExtra)
grid.arrange(p1, p2, labels = c("A", "B"), ncol = 2)
p1 <- ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange")
p2 <- ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass()
grid.arrange(p1, p2, labels = c("A", "B"), ncol = 2)
ggarrange(p1, p2, labels = c("A", "B"), ncol = 2)
install.packages("ggpubr")
library(ggpubr)
library(ggpubr)
install.packages("ggpubr", dependencies = T)
library(ggpubr)
install.packages("cowplot")
devtools::install("cowplot")
devtools::install_github("wilkelab/cowplot")
grid.arrange(p1, p2, ncol = 2)
p2
grid.arrange(p1, p2, ncol = 2, nrow = 1)
p1 <- ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
p2 <- ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass()
grid.arrange(p1, p2, ncol = 2)
p2 <- ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
ggplot(full_perfs, aes(P_act_root, P_act_shoot)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
ggplot(full_perfs_r, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_root)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
ggplot(full_perfs_r, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau"), trait.values = c(sp[c(1,2,6,7)], 0.2), parameters = pp, plasticity = "fixed_equilibrium")
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
colnames(full_perfs)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[11],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[8]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p1 <- ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p2 <- ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
ggplot(full_perfs_r, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
ggplot(full_perfs_r, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
dev.off()
ggplot(full_perfs_r, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[11],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[8]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p1 <- ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p2 <- ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
# with plasticity:
perfs_pl <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau"), trait.values = c(sp[c(1,2,6,7)], 0.2), parameters = pp, plasticity = "fixed-equilibrium")
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs_pl <- cbind(threeDspace1, perfs_pl)
colnames(full_perfs_pl)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs_pl, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_pl, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_pl, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r_pl <- full_perfs_pl[full_perfs_pl$P_act_root == unique(full_perfs_pl$P_act_root)[11],]
full_perfs_r_pl$focus <- F
full_perfs_r_pl$focus[full_perfs_r_pl$P_act_shoot == unique(full_perfs_r_pl$P_act_shoot)[8]] <- T
ggplot(full_perfs_r_pl, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p1 <- ggplot(full_perfs_r_pl, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p2 <- ggplot(full_perfs_r_pl, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
ggplot(full_perfs_r_pl, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_pl, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
# another condition, no plasticity
perfs2 <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp, climatic.var = "Rain", climatic.values = 1)
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
colnames(full_perfs)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r2 <- full_perfs[full_perfs2$P_act_root == unique(full_perfs2$P_act_root)[11],]
full_perfs_r2$focus <- F
full_perfs_r2$focus[full_perfs_r2$P_act_shoot == unique(full_perfs_r2$P_act_shoot)[8]] <- T
ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p12 <- ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p22 <- ggplot(full_perfs_r2, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p12, p22, ncol = 2)
ggplot(full_perfs_r2, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
full_perfs2 <- cbind(threeDspace1, perfs2)
colnames(full_perfs2)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r2 <- full_perfs[full_perfs2$P_act_root == unique(full_perfs2$P_act_root)[11],]
full_perfs_r2$focus <- F
full_perfs_r2$focus[full_perfs_r2$P_act_shoot == unique(full_perfs_r2$P_act_shoot)[8]] <- T
ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p12 <- ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p22 <- ggplot(full_perfs_r2, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p12, p22, ncol = 2)
ggplot(full_perfs_r2, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
full_perfs_r2 <- full_perfs2[full_perfs2$P_act_root == unique(full_perfs2$P_act_root)[11],]
full_perfs_r2$focus <- F
full_perfs_r2$focus[full_perfs_r2$P_act_shoot == unique(full_perfs_r2$P_act_shoot)[8]] <- T
ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p12 <- ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p22 <- ggplot(full_perfs_r2, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p12, p22, ncol = 2)
perfs2 <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp, climatic.var = c("light", "Rain"), climatic.values = c(122 *25, 1))
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs2 <- cbind(threeDspace1, perfs2)
colnames(full_perfs2)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r2 <- full_perfs2[full_perfs2$P_act_root == unique(full_perfs2$P_act_root)[11],]
full_perfs_r2$focus <- F
full_perfs_r2$focus[full_perfs_r2$P_act_shoot == unique(full_perfs_r2$P_act_shoot)[8]] <- T
ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p12 <- ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p22 <- ggplot(full_perfs_r2, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p12, p22, ncol = 2)
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp, climatic.var = c("light", "Rain"), climatic.values = c(60 *25, 4))
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
#  Show how the performance landscape is defined by phenotypic traits SRL, SLA and RSR and how plastic dimension matter.
library(mountgrass)
library(ggplot2)
library(reshape2)
library(dplyr)
library(readr)
library(tidyr)
library(purrr)
# library(randomForest)
library(parallel)
library(ggpubr)
# folder <- commandArgs(trailingOnly = T)
folder <- "/mnt/quadri1/simulations/exploration/species_par_space2017-10-26/"
parameters <-  read_rds(paste0(c(folder, "parameters.rds"), collapse = ""))
colnames(parameters) <-
c(
"par_v",
colnames(default_parameters),
c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau", "algo")
)
#
#
parameters <- as.data.frame(parameters)
var_trait <- c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau", "algo")
# changing <-
#   colnames(default_parameters)[c(1:7, 11, 13:19, 26:28, 31:40)]
# changing <- c("par_v", changing, var_trait)
parameters <- as.data.frame(parameters)
print(folder)
print(head(parameters))
# Best strategy and memory
# range of strats
accepted <- read_rds(paste0(c(folder, "accected_lognorm.rds"), collapse = ""))
acc <- accepted[rowSums(accepted[,2:12])>0, 1]
# filtering
par <- parameters[acc,2:41]
# choose one parameter set (until you get one default one)
pp <- par[1,]
# Define a
n <- 12
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp, climatic.var = c("light", "Rain"), climatic.values = c(60 *25, 4))
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
#  Show how the performance landscape is defined by phenotypic traits SRL, SLA and RSR and how plastic dimension matter.
library(mountgrass)
library(ggplot2)
library(reshape2)
library(dplyr)
library(readr)
library(tidyr)
library(purrr)
# library(randomForest)
library(parallel)
library(gridExtra)
# folder <- commandArgs(trailingOnly = T)
folder <- "/mnt/quadri1/simulations/exploration/species_par_space2017-10-26/"
parameters <-  read_rds(paste0(c(folder, "parameters.rds"), collapse = ""))
colnames(parameters) <-
c(
"par_v",
colnames(default_parameters),
c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau", "algo")
)
#
#
parameters <- as.data.frame(parameters)
var_trait <- c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau", "algo")
# changing <-
#   colnames(default_parameters)[c(1:7, 11, 13:19, 26:28, 31:40)]
# changing <- c("par_v", changing, var_trait)
parameters <- as.data.frame(parameters)
print(folder)
print(head(parameters))
# Best strategy and memory
# range of strats
accepted <- read_rds(paste0(c(folder, "accected_lognorm.rds"), collapse = ""))
acc <- accepted[rowSums(accepted[,2:12])>0, 1]
# filtering
par <- parameters[acc,2:41]
# choose one parameter set (until you get one default one)
pp <- par[1,]
# Define a
n <- 12
threeDspace1 <- expand.grid(seq(0.01,0.99, length = n), seq(0.01,0.99, length = n), seq(0.01,0.99, length = n))
threeDspace <- threeDspace1 / (1 - threeDspace1)
param_tc <- pp[31:40]
threeDspace$SLA <- CtoSLA(threeDspace$Var1, param_tc$th, param_tc$vt_s, param_tc$rho_as, param_tc$rho_ss)
threeDspace$SRL <- CtoSRL(threeDspace$Var2, param_tc$s_r, param_tc$rho_ar, param_tc$rho_sr)
threeDspace$l_ini <- 1
threeDspace$w_ini <- (threeDspace$SLA * threeDspace$l_ini) / (threeDspace$SRL * 2 * pi * sqrt(param_tc$s_r/pi)* threeDspace$Var3)
threeDspace$sp <- 1:dim(threeDspace)[1]
perfs <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp, climatic.var = c("light", "Rain"), climatic.values = c(60 *25, 4))
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs <- cbind(threeDspace1, perfs)
colnames(full_perfs)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r <- full_perfs[full_perfs$P_act_root == unique(full_perfs$P_act_root)[11],]
full_perfs_r$focus <- F
full_perfs_r$focus[full_perfs_r$P_act_shoot == unique(full_perfs_r$P_act_shoot)[8]] <- T
ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p1 <- ggplot(full_perfs_r, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p2 <- ggplot(full_perfs_r, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
# ggplot(full_perfs_r, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
# another condition, no plasticity
perfs2 <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini"), trait.values = c(sp[c(1,2,6,7)]), parameters = pp, climatic.var = c("light", "Rain"), climatic.values = c(122 *25, 1))
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs2 <- cbind(threeDspace1, perfs2)
colnames(full_perfs2)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r2 <- full_perfs2[full_perfs2$P_act_root == unique(full_perfs2$P_act_root)[11],]
full_perfs_r2$focus <- F
full_perfs_r2$focus[full_perfs_r2$P_act_shoot == unique(full_perfs_r2$P_act_shoot)[8]] <- T
ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p12 <- ggplot(full_perfs_r2, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p22 <- ggplot(full_perfs_r2, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p12, p22, ncol = 2)
# ggplot(full_perfs_r2, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
# with plasticity:
perfs_pl <- rbind.fill(apply(threeDspace, 1, function(sp, pp){
pot <- pot_simulation(trait = c("as_s_d", "as_r_d", "l_ini", "w_ini", "tau"), trait.values = c(sp[c(1,2,6,7)], 0.2), parameters = pp, plasticity = "fixed-equilibrium")
pot$sp <- sp[8]
return(pot[length(pot$day),])
}, pp))
full_perfs_pl <- cbind(threeDspace1, perfs_pl)
colnames(full_perfs_pl)[1:3] <- c("P_act_shoot", "P_act_root", "P_root")
ggplot(full_perfs_pl, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_pl, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_pl, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
full_perfs_r_pl <- full_perfs_pl[full_perfs_pl$P_act_root == unique(full_perfs_pl$P_act_root)[11],]
full_perfs_r_pl$focus <- F
full_perfs_r_pl$focus[full_perfs_r_pl$P_act_shoot == unique(full_perfs_r_pl$P_act_shoot)[8]] <- T
ggplot(full_perfs_r_pl, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
p1 <- ggplot(full_perfs_r_pl, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "grey70") + coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass() + geom_vline(xintercept = unique(full_perfs_r$P_act_shoot)[8], colour = "orange") + theme(legend.position = "none", aspect.ratio = 1)
p2 <- ggplot(full_perfs_r_pl, aes(P_root, BM_ag + BM_bg)) + geom_line(aes(colour = focus, group = P_act_shoot)) + scale_colour_manual(values = c("grey70", "orange")) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
grid.arrange(p1, p2, ncol = 2)
ggplot(full_perfs_r_pl, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
# compare with no pl:
full_perf_pl$pl <- T
full_perf$pl <- F
full_perfs_delta <- rbind(full_perfs, full_perfs_pl)
ggplot(full_perfs_r_pl, aes(P_act_shoot, P_root)) + geom_tile(aes(fill = BM_ag + BM_bg)) + facet_wrap(~P_act_root) + coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_r_pl, aes( P_act_shoot , BM_ag + BM_bg)) + geom_line(aes(colour = P_root, group = P_root)) + theme_mountgrass() + theme(legend.position = "none", aspect.ratio = 1)
full_perf_pl$pl <- T
full_perfs_pl$pl <- T
full_perfs$pl <- F
full_perfs_delta <- rbind(full_perfs, full_perfs_pl)
ggplot(full_perfs_pl, aes(P_act_root, P_act_shoot))+ geom_tile(aes(fill = BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg), colour = "white") + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1)) + theme_mountgrass()
ggplot(full_perfs_pl, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_delta, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg, colour = pl)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
install.packages("directlabels")
library(directlabels)
pc <- ggplot(full_perfs_delta, aes(P_act_shoot, P_root)) + geom_contour(aes(z = BM_ag + BM_bg, colour = pl)) + facet_wrap(~P_act_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
direct.label(pc,  list("far.from.others.borders", "calc.boxes", "enlarge.box",
box.color = NA, fill = "transparent", "draw.rects"))
ggplot(full_perfs_delta, aes(P_act_shoot, BM_ag + BM_bg)) + geom_contour(aes(z = BM_ag + BM_bg, colour = pl, group = P_act_root)) + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_delta, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = pl, group = interaction(P_act_root, pl)) + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_delta, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = pl, group = interaction(P_act_root, pl))) + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_delta, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = pl, group = interaction(P_act_root, pl))) + facet_wrap(~P_root)+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs_delta, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = pl, group = interaction(P_act_root, pl))) + facet_wrap(~P_root)#+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs2, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = P_act_root, group = interaction(P_act_root))) + facet_wrap(~P_root)#+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
ggplot(full_perfs, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = P_act_root, group = interaction(P_act_root))) + facet_wrap(~P_root)#+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
install.packages("plotly")
devtools::install_github("ropensci/plotly")
library(plotly)
p <- plot_ly(midwest, x = ~percollege, color = ~state, type = "box")
p
library(plotly)
library(ggplot2)
ggplot(full_perfs, aes(P_act_shoot, BM_ag + BM_bg)) + geom_line(aes( colour = P_act_root, group = interaction(P_act_root))) + facet_wrap(~P_root)#+ coord_fixed(xlim = c(0,1), ylim = c(0,1))
install.packages("ggplot2")
library(ggplot2)
install.packages("plotly")
library(ggplot2)
library(plotly)
